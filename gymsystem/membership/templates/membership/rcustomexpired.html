<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Home</title>
	<link rel="stylesheet" href="../../static/css/rcustomexpired.css">
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous"> -->
	  <!-- Fonts -->
	  <!-- Fonts -->
	  <link rel="preconnect" href="https://fonts.googleapis.com">
	  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Poppins:wght@300;500;600;700;800&display=swap" rel="stylesheet">
	  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
	  <link href="https://fonts.googleapis.com/css2?family=Hind:wght@300;400;500;600;700&family=Kanit:wght@100&family=Yantramanav:wght@400;500;700;900&display=swap" rel="stylesheet">
	  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
	  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
</head>
<body>
	<div id="content", name="content">
		<div class="grid_container">
			{% if request.user.is_authenticated %}
            <form action="" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="payment_pic_container">
                    <img src="../../static/files/GCASH.png" width="400px" height="600px" alt="Owner GCASH acount">
                </div>
                <div class="details_container">
                    <h2>Renew Expired Custom Membership</h2>
                    <h3>REMINDER: Please double check the date before you submit</h3>

                    <div class="buttons_container">
                        <h3>Current START DATE</h3>
                        <div class="row">
                            <input type="text" name="start_date" value="{{users.start_date|date:'m-d-Y'}}" readonly>
                        </div>
                        <h3>Current END DATE</h3>
                        <div class="row">
                            <input type="text" name="end_date" value="{{users.end_date|date:'m-d-Y'}}" readonly>
                        </div>
                        <h3>Pick a NEW START DATE</h3>
                        <div class="row">
                            <input type="date" id="renew_startdate" name="renew_startdate" required/>
                        </div>
                        <h3>Pick a NEW END DATE</h3>
                        <div class="row">
                            <input type="date" id="renew_enddate" name="renew_enddate" required/>
                        </div>
                    </div>    

                    <div class="instructions_container">
                        <h3><span id="price"></span></h3>
                        <div class="instructions_reminder">
                            <h2>Attachments</h2>
                            <h3>REMINDER: Scan the GCASH qr code to pay. Don't forget to screenshot and attach the receipt.</h3>
                        </div>
                        <div class="buttons_container">
                            <input type="file" name="renew" required>
                            <button class="renew" type="submit">Renew</button>
                            <button class="go_back"type="button"><a href="/home">Go Back</a></button>
                        </div>
                    </div>
                    </div>
                </div>
            </form>
            {% endif %}
	    </div>
	</div>
	<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script> -->
    <script>
        function calculatePrice() {
            var orig_start_date = new Date("{{users.start_date}}");
            var orig_end_date = new Date("{{users.end_date}}");
            var renew_start_date = new Date(document.getElementById("renew_startdate").value);
            var renew_end_date = new Date(document.getElementById("renew_enddate").value);

            if (isNaN(renew_start_date.getTime()) || isNaN(renew_end_date.getTime())) {
                document.getElementById("price").innerHTML = "...";
                return;
            }
            
            if (renew_start_date.getTime() === orig_start_date.getTime() && renew_end_date.getTime() === orig_end_date.getTime()) {
                document.getElementById("price").innerHTML = "Please pick different start and end dates";
                return;
            }

            if (renew_start_date.getTime() === orig_start_date.getTime()) {
                document.getElementById("price").innerHTML = "Please pick a different start date";
                return;
            }

            if (renew_end_date.getTime() === orig_end_date.getTime()) {
                document.getElementById("price").innerHTML = "Please pick a different end date";
                return;
            }

            if (renew_start_date > renew_end_date) {
                document.getElementById("price").innerHTML = "Please provide a valid start and end date";
                return;
            }

            var daysDiff = Math.ceil((renew_end_date - renew_start_date) / (1000 * 60 * 60 * 24));
            var price = daysDiff * 25;
            document.getElementById("price").innerHTML = "PRICE: â‚±" + price + ".00";
            }

            document.getElementById("renew_startdate").addEventListener("change", calculatePrice);
            document.getElementById("renew_enddate").addEventListener("change", calculatePrice);
    </script>
</body>
</html>